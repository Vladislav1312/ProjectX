# MARKOV | Next Level — Telegram Bot

Telegram-бот для проекта **MARKOV | Next Level**: жёсткая RPG-оболочка для фиксации фактов и неизбежных последствий. Бот действует как мастер игры — нейтральный, холодный и последовательный. Он выдаёт задания, принимает результаты и на основе фактов корректирует правила.

## Цели проекта
- Фиксация реальных действий пользователя без мотивационной риторики.
- Жёсткая временная логика: день → неделя → месяц → уровень.
- Невозможность «переписать прошлое» — все события записываются неизменно.

## Ключевые правила системы
- **День**: бот выдаёт фиксированные задания, переносы запрещены. Отсутствие фиксации = провал.
- **Неделя**: автоматическая адаптация нагрузки без изменения уровня.
- **Месяц**: оценка уровня строго по фактам (выполнение, закрытые недели, критические провалы).
- **Уровень**: набор ограничений и условий, а не «награда».

## Архитектура (MVP)
- `markov_bot/domain.py` — доменные модели: навыки, задания, события.
- `markov_bot/storage.py` — SQLite-хранилище с неизменяемым журналом событий.
- `markov_bot/services.py` — правила выдачи заданий и аналитика.
- `markov_bot/bot.py` — Telegram-обвязка (python-telegram-bot).

## Быстрый старт
```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
export MARKOV_TELEGRAM_TOKEN="<token>"
python -m markov_bot.bot
```

### Примечание для Windows (PowerShell)
Если видите ошибку `There is no current event loop in thread 'MainThread'`, убедитесь, что запускаете бота из PowerShell с активным виртуальным окружением. В коде уже настроен явный event loop для Windows.

## Команды (планируемые)
- `/start` — регистрация пользователя.
- `/day` — выдать задания на день.
- `/done <task_id>` — зафиксировать выполнение.
- `/fail <task_id>` — зафиксировать провал.
- `/status` — статус дня/недели.
- `/week` — отчёт недели.
- `/month` — отчёт месяца.

## Принципы данных
- Все события пишутся в журнал (append-only).
- Изменение истории и «задним числом» запрещены.

## Лицензия
MIT
